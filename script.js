// البيانات متعددة اللغات
const translations = {
    ar: {
        name: "عماد عبدالحافظ حسن الاديب",
        title: "مهندس حاسوب ومطور برمجيات",
        heroDescription: "مهندس حاسوب وتحكم شغوف بخبرة في تطوير الويب وتطبيقات الأندرويد، وإعداد الشبكات والإدارة. مهتم بشدة بالذكاء الاصطناعي وأنظمة الأتمتة والشبكات والأمن السيبراني.",
        downloadPdf: "تحميل PDF",
        whatsapp: "واتساب",
        linkedin: "لينكدإن",
        github: "جيت هاب",
        email: "بريد إلكتروني",
        aboutTitle: "عنّي",
        aboutDescription: "مهندس حاسوب وتحكم شغوف بخبرة في تطوير الويب وتطبيقات الأندرويد، بالإضافة إلى إعداد الشبكات والإدارة. مهتم بشدة بالذكاء الاصطناعي وأنظمة الأتمتة والشبكات والأمن السيبراني. أمتلك مهارات حاسوبية قوية ومكتبية، مما يمكنني من التنفيذ الفعال للمهام التقنية. أسعى لتطوير مهاراتي أكثر في بيئة عمل مهنية وديناميكية والمساهمة في مشاريع تقنية مبتكرة ومؤثرة.",
        educationTitle: "التعليم",
        degreeTitle: "بكالوريوس في هندسة الحاسوب والتحكم",
        university: "جامعة إب - اليمن",
        grade: "نسبة التخرج: 81.30 (2024)",
        expertiseTitle: "الخبرات",
        communication: "مهارات التواصل",
        teamwork: "القدرة على العمل في فريق",
        security: "الإبداع والابتكار",
        problemSolving: "مهارات حل المشاكل",
        fastLearner: "متعلم سريع",
        flexibility: "المرونة واحترام عمل الفريق",
        pressure: "القدرة على العمل تحت الضغط",
        skillsTitle: "المهارات",
        searchSkills: "ابحث عن مهارة...",
        projectsTitle: "البحوث والمشاريع",
        graduationProject: "مشروع التخرج: AI-SDDS",
        graduationDescription: "(نظام تشخيص أمراض الجلد بالذكاء الاصطناعي) \"تطبيق ويب\"",
        kidsStyle: "kidsStyle",
        kidsStyleDescription: "متجر إلكتروني عصري لملابس الأطفال",
        cityGuide: "CityGuide",
        cityGuideDescription: "دليل تفاعلي للمدينة للسفر والاستكشاف",
        foodyPal: "FoodyPal",
        foodyPalDescription: "موقع مطعم احترافي بواجهة حديثة",
        studentManagement: "نظام إدارة الطلاب",
        studentManagementDescription: "نظام شامل لإدارة بيانات الطلاب والدرجات",
        viewProject: "عرض المشروع",
        certificatesTitle: "الشهادات",
        networkingBasics: "أساسيات الشبكات",
        modernAI: "مقدمة في الذكاء الاصطناعي الحديث",
        cybersecurity: "مقدمة في الأمن السيبراني",
        drivingLicense: "رخصة قيادة كمبيوتر من جامعة صنعاء",
        networkTroubleshooting: "عنونة الشبكات واستكشاف الأخطاء الأساسية",
        laravelFramework: "إطار عمل Laravel للمبتدئين",
        contactTitle: "تواصل معي",
        location: "إب - اليمن",
        nameLabel: "الاسم",
        emailLabel: "البريد الإلكتروني",
        subjectLabel: "الموضوع",
        messageLabel: "الرسالة",
        sendMessage: "إرسال الرسالة",
        footerText: "© 2025 عماد عبدالحافظ حسن الاديب. جميع الحقوق محفوظة.",
        skill1: "➢ أدوات مايكروسوفت أوفيس",
        skill2: "➢ أنظمة التشغيل (Windows وأساسيات Linux)",
        skill3: "➢ فهم بروتوكولات ومعايير الاتصالات",
        skill4: "➢ معرفة جيدة بعمليات التوجيه والتبديل وبروتوكولات الشبكة مثل (TCP/IP, OSPF, STP, VTP, وغيرها)",
        skill5: "➢ استكشاف الأخطاء ومهارات قوية في حل المشاكل والتحليل",
        skill6: "➢ الذكاء الاصطناعي: نماذج التعلم العميق، تكامل الذكاء الاصطناعي",
        skill7: "➢ لغات البرمجة: Python, Matlab, C++, C#, Java, HTML, CSS, JavaScript, PHP, MySQL, Laravel"
    },
    en: {
        name: "Emad Abdulhafeez Hassan Al-Adeep",
        title: "Computer Engineer & Software Developer",
        heroDescription: "A passionate Computer and Control Engineer with experience in web development, Android applications, as well as network setup and administration. Deeply interested in artificial intelligence, automation systems, networking, and cybersecurity.",
        downloadPdf: "Download PDF",
        whatsapp: "WhatsApp",
        linkedin: "LinkedIn",
        github: "GitHub",
        email: "Email",
        aboutTitle: "About Me",
        aboutDescription: "A passionate Computer and Control Engineer with experience in web development, Android applications, as well as network setup and administration. Deeply interested in artificial intelligence, automation systems, networking, and cybersecurity. Possess strong computer and office skills, enabling efficient execution of technical tasks. Seeking to further develop my skills in a professional and dynamic work environment and contribute to innovative and impactful tech projects.",
        educationTitle: "Education",
        degreeTitle: "Bachelor in Computer Engineering and Control",
        university: "Ibb University - Yemen",
        grade: "Percent grade: 81.30 (2024)",
        expertiseTitle: "Expertise",
        communication: "Communication skills",
        teamwork: "Ability to work in team",
        security: "Creativity and innovation",
        problemSolving: "Problem-solving skills",
        fastLearner: "Fast learner",
        flexibility: "Flexibility & Respect team work",
        pressure: "Ability to work under pressure",
        skillsTitle: "Skills",
        searchSkills: "Search for a skill...",
        projectsTitle: "Research and Projects",
        graduationProject: "Graduation Project: AI-SDDS",
        graduationDescription: "(AI-Based Skin Disease Diagnosis System) \"App and Web\"",
        kidsStyle: "kidsStyle",
        kidsStyleDescription: "A Trendy Online store for Kids' clothing",
        cityGuide: "CityGuide",
        cityGuideDescription: "Interactive City Directory for Travel and Discovery",
        foodyPal: "FoodyPal",
        foodyPalDescription: "A professional Restaurant Website with a Modern interface",
        studentManagement: "Student Management System",
        studentManagementDescription: "Comprehensive system for managing student data and grades",
        viewProject: "View Project",
        certificatesTitle: "Certificates",
        networkingBasics: "Networking basics",
        modernAI: "Introduction to modern AI",
        cybersecurity: "Introduction to cybersecurity",
        drivingLicense: "Sana'a university computer driving license",
        networkTroubleshooting: "Network addressing and basic troubleshooting",
        laravelFramework: "Laravel framework for beginners",
        contactTitle: "Contact Me",
        location: "Ibb - Yemen",
        nameLabel: "Name",
        emailLabel: "Email",
        subjectLabel: "Subject",
        messageLabel: "Message",
        sendMessage: "Send Message",
        footerText: "© 2025 Emad Abdulhafeez Hassan Al-Adeep. All rights reserved.",
        skill1: "➢ Microsoft office tools",
        skill2: "➢ Operating Systems (Windows & Basics of Linux)",
        skill3: "➢ Understanding of telecommunication protocols and standards",
        skill4: "➢ Good knowledge of Routing & Switching operations and network protocols Such (TCP/IP, OSPF, STP, VTP, and others)",
        skill5: "➢ Troubleshooting, strong problem-solving and analytical skills",
        skill6: "➢ Artificial Intelligence: Deep learning models, AI integration",
        skill7: "➢ Programming Languages: Python, Matlab, C++, C#, Java, HTML, CSS, JavaScript, PHP, MySQL, Laravel"
    }
};

// متغيرات عامة
let currentLanguage = localStorage.getItem('language') || 'ar';
let currentTheme = localStorage.getItem('theme') || 'light';

// تهيئة EmailJS - سيتم تعيين المفاتيح لاحقاً
// تحقق من وجود EmailJS وتهيئته إذا كان متاحاً
if (typeof emailjs !== 'undefined') {
    emailjs.init("YOUR_EMAILJS_PUBLIC_KEY"); // يجب استبدال هذا بالمفتاح الفعلي
}

// تهيئة الصفحة عند التحميل
document.addEventListener('DOMContentLoaded', function() {
    initializeLanguage();
    initializeTheme();
    initializeSkillsFilter();
    initializeContactForm();
    initializeEventListeners();
});

// تهيئة اللغة
function initializeLanguage() {
    const html = document.documentElement;
    const langToggle = document.getElementById('langToggle');
    
    if (currentLanguage === 'ar') {
        html.setAttribute('lang', 'ar');
        html.setAttribute('dir', 'rtl');
        langToggle.textContent = 'EN';
    } else {
        html.setAttribute('lang', 'en');
        html.setAttribute('dir', 'ltr');
        langToggle.textContent = 'AR';
    }
    
    updateTranslations();
}

// تحديث الترجمات
function updateTranslations() {
    const elements = document.querySelectorAll('[data-key]');
    elements.forEach(element => {
        const key = element.getAttribute('data-key');
        if (translations[currentLanguage][key]) {
            element.textContent = translations[currentLanguage][key];
        }
    });
    
    // تحديث placeholder للبحث
    const searchInput = document.getElementById('skillsSearch');
    if (searchInput) {
        searchInput.placeholder = translations[currentLanguage].searchSkills;
    }
    
    // تحديث عنوان الصفحة
    document.title = translations[currentLanguage].name + ' - ' + translations[currentLanguage].title;
    
    // إجبار إعادة تحديث المهارات
    const skillElements = document.querySelectorAll('.skill-tag[data-key]');
    skillElements.forEach(element => {
        const key = element.getAttribute('data-key');
        if (translations[currentLanguage][key]) {
            element.textContent = translations[currentLanguage][key];
        }
    });
}

// تبديل اللغة
function toggleLanguage() {
    currentLanguage = currentLanguage === 'ar' ? 'en' : 'ar';
    localStorage.setItem('language', currentLanguage);
    initializeLanguage();
}

// تهيئة السمة
function initializeTheme() {
    document.documentElement.setAttribute('data-theme', currentTheme);
    updateThemeIcon();
}

// تحديث أيقونة السمة
function updateThemeIcon() {
    const themeToggle = document.getElementById('themeToggle');
    const icon = themeToggle.querySelector('svg');
    
    if (currentTheme === 'dark') {
        // أيقونة القمر للوضع الداكن
        icon.innerHTML = `
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        `;
    } else {
        // أيقونة الشمس للوضع الفاتح
        icon.innerHTML = `
            <circle cx="12" cy="12" r="5"/>
            <line x1="12" y1="1" x2="12" y2="3"/>
            <line x1="12" y1="21" x2="12" y2="23"/>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
            <line x1="1" y1="12" x2="3" y2="12"/>
            <line x1="21" y1="12" x2="23" y2="12"/>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        `;
    }
}

// تبديل السمة
function toggleTheme() {
    currentTheme = currentTheme === 'light' ? 'dark' : 'light';
    localStorage.setItem('theme', currentTheme);
    initializeTheme();
}

// تهيئة مرشح المهارات
function initializeSkillsFilter() {
    const searchInput = document.getElementById('skillsSearch');
    const skillTags = document.querySelectorAll('.skill-tag');
    
    searchInput.addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase();
        
        skillTags.forEach(tag => {
            const skillText = tag.textContent.toLowerCase();
            const skillAttr = tag.getAttribute('data-skill').toLowerCase();
            
            if (skillText.includes(searchTerm) || skillAttr.includes(searchTerm)) {
                tag.classList.remove('hidden');
            } else {
                tag.classList.add('hidden');
            }
        });
    });
}

// تهيئة نموذج التواصل
function initializeContactForm() {
    const form = document.getElementById('contactForm');
    
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(form);
        const templateParams = {
            from_name: formData.get('name'),
            from_email: formData.get('email'),
            subject: formData.get('subject'),
            message: formData.get('message'),
            to_name: translations[currentLanguage].name
        };
        
        // إظهار رسالة تحميل
        const submitBtn = form.querySelector('.btn-submit');
        const originalText = submitBtn.textContent;
        submitBtn.textContent = currentLanguage === 'ar' ? 'جاري الإرسال...' : 'Sending...';
        submitBtn.disabled = true;
        
        // إرسال البريد الإلكتروني - يتطلب إعداد EmailJS
        // التحقق من وجود EmailJS
        if (typeof emailjs !== 'undefined') {
            emailjs.send(
                'YOUR_SERVICE_ID', // يجب استبدال هذا بمعرف الخدمة الخاص بك
                'YOUR_TEMPLATE_ID', // يجب استبدال هذا بمعرف القالب الخاص بك
                templateParams
            ).then(function(response) {
                console.log('SUCCESS!', response.status, response.text);
                alert(currentLanguage === 'ar' ? 'تم إرسال الرسالة بنجاح!' : 'Message sent successfully!');
                form.reset();
            }).catch(function(error) {
                console.error('FAILED...', error);
                alert(currentLanguage === 'ar' ? 'فشل في إرسال الرسالة. يرجى المحاولة مرة أخرى.' : 'Failed to send message. Please try again.');
            }).finally(function() {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            });
        } else {
            // إذا لم يكن EmailJS متاحاً، إظهار رسالة بديلة
            alert(currentLanguage === 'ar' ? 'خدمة الإرسال غير متاحة حالياً. يرجى التواصل مباشرة عبر الواتساب أو البريد الإلكتروني.' : 'Email service is not available. Please contact directly via WhatsApp or email.');
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        }
    });
}

// تحميل PDF
function downloadPDF() {
    // إعداد النافذة للطباعة
    const originalTitle = document.title;
    document.title = translations[currentLanguage].name + ' - CV';
    
    // فتح نافذة الطباعة
    window.print();
    
    // استعادة العنوان الأصلي
    document.title = originalTitle;
}

// تهيئة مستمعي الأحداث
function initializeEventListeners() {
    // تبديل اللغة
    document.getElementById('langToggle').addEventListener('click', toggleLanguage);
    
    // تبديل السمة
    document.getElementById('themeToggle').addEventListener('click', toggleTheme);
    
    // تحميل PDF
    document.getElementById('downloadPdf').addEventListener('click', downloadPDF);
    
    // التمرير السلس للروابط الداخلية
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    
    // إضافة كلاسات الحركة عند التمرير
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.animation = 'fadeInUp 1s ease-out';
            }
        });
    }, observerOptions);
    
    // مراقبة العناصر القابلة للحركة
    document.querySelectorAll('.expertise-item, .project-card, .certificate-item, .skill-tag').forEach(el => {
        observer.observe(el);
    });
}

// تحديث ارتفاع العناصر عند تغيير حجم النافذة
window.addEventListener('resize', function() {
    // إعادة حساب التخطيط إذا لزم الأمر
    const heroContent = document.querySelector('.hero-content');
    if (heroContent && window.innerWidth <= 768) {
        heroContent.style.textAlign = 'center';
    }
});

// معالجة الأخطاء العامة
window.addEventListener('error', function(e) {
    console.error('خطأ في الصفحة:', e.error);
});

// تصدير الوظائف للاستخدام العام
window.portfolioApp = {
    toggleLanguage,
    toggleTheme,
    downloadPDF,
    translations,
    currentLanguage,
    currentTheme
};
